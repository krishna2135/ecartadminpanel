{"ast":null,"code":"import _classCallCheck from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\src\\\\components\\\\Categories\\\\Category.jsx\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { url, headers } from '../../config';\nimport _ from 'lodash';\nimport { connect } from 'react-redux';\nimport Loading from '../Loading';\nimport SubCategory from './SubCategory';\n\nvar Category =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Category, _Component);\n\n  function Category() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Category);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Category)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      open_update: true,\n      open_add: true,\n      comfirm_delete: true,\n      name: '',\n      message: '',\n      sub_categories: [],\n      loading: false\n    };\n\n    _this.fetchSubCategories = function () {\n      axios.get(url + '/app/product/subcategory/' + _this.props.category.category_id).then(function (res) {\n        console.log(res.data);\n        if (_.isArray(res.data.datasub)) _this.setState({\n          sub_categories: res.data.datasub\n        });else _this.setState({\n          sub_categories: []\n        });\n      });\n    };\n\n    _this.openUpdateCategory = function (name) {\n      _this.setState({\n        name: name,\n        open_update: !_this.state.open_update,\n        message: ''\n      });\n    };\n\n    _this.openAddSubCategory = function () {\n      _this.setState({\n        open_add: !_this.state.open_add,\n        message: ''\n      });\n    };\n\n    _this.handleImage = function (e) {\n      var file = e.target.files[0];\n      var reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onloadend = function () {\n        _this.setState({\n          file: file,\n          image: reader.result\n        });\n      };\n    };\n\n    return _this;\n  }\n\n  _createClass(Category, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var sub_categories = this.props.category.subcategories;\n\n      if (sub_categories) {\n        this.setState({\n          sub_categories: sub_categories\n        });\n      }\n\n      this.fetchSubCategories();\n    }\n  }, {\n    key: \"deleteCategory\",\n    value: function deleteCategory(id) {\n      var _this2 = this;\n\n      axios.delete(url + '/category/' + id, headers(this.props.user.token)).then(function (res) {\n        _this2.props.update();\n      });\n    }\n  }, {\n    key: \"updateCategory\",\n    value: function updateCategory(e, id) {\n      var _this3 = this;\n\n      e.preventDefault();\n      var data = {\n        name: this.state.name\n      };\n      axios.put(url + '/category/' + id, data, headers(this.props.user.token)).then(function (res) {\n        _this3.setState({\n          message: 'Success update category',\n          open_update: true\n        });\n\n        _this3.props.update();\n      }).catch(function (err) {\n        _this3.setState({\n          message: 'Failed update category'\n        });\n      });\n    }\n  }, {\n    key: \"addSubCategory\",\n    value: function addSubCategory(e, id) {\n      var _this4 = this;\n\n      e.preventDefault();\n      var _this$state = this.state,\n          name = _this$state.name,\n          file = _this$state.file;\n      this.setState({\n        loading: true\n      });\n      var formData = new FormData();\n      formData.append('image', file);\n      axios.post(url + \"/subcategory/upload-image\", formData).then(function (res) {\n        var data = {\n          name: name,\n          image: res.data.url,\n          category_id: id\n        };\n        axios.post(url + '/subcategory', data, headers(_this4.props.user.token)).then(function (res) {\n          _this4.fetchSubCategories();\n\n          _this4.setState({\n            message: 'Success add subcategory',\n            open_add: true,\n            name: '',\n            image: null,\n            loading: false\n          });\n        }).catch(function (err) {\n          _this4.setState({\n            message: 'Failed add subcategory',\n            loading: false\n          });\n        });\n      }).catch(function (err) {\n        _this4.setState({\n          message: 'Failed upload image',\n          loading: false\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var _this$state2 = this.state,\n          loading = _this$state2.loading,\n          image = _this$state2.image,\n          open_update = _this$state2.open_update,\n          name = _this$state2.name,\n          open_add = _this$state2.open_add,\n          comfirm_delete = _this$state2.comfirm_delete,\n          message = _this$state2.message,\n          sub_categories = _this$state2.sub_categories;\n      var category = this.props.category;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, loading && React.createElement(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }), React.createElement(\"span\", {\n        className: \"message\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, message), React.createElement(\"div\", {\n        className: \"category\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, category.category_name)), React.createElement(\"div\", {\n        className: \"actions\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        onClick: function onClick() {\n          _this5.setState({\n            comfirm_delete: false\n          });\n        },\n        className: \"delete\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"demo-icon icon-minus\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, \"\\uE814\")), React.createElement(\"div\", {\n        onClick: function onClick() {\n          _this5.openUpdateCategory(category.category_name);\n        },\n        className: \"update\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"demo-icon icon-cog\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, \"\\uE81A\")), React.createElement(\"div\", {\n        onClick: this.openAddSubCategory,\n        className: \"add\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, open_add ? React.createElement(\"i\", {\n        className: \"demo-icon icon-plus\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, \"\\uE808\") : React.createElement(\"i\", {\n        className: \"demo-icon icon-cancel\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, \"\\uE80F\")))), //open comfirm delete category\n      comfirm_delete ? '' : React.createElement(\"div\", {\n        className: \"comfirm-delete\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, \"Are you sure want to delete?\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          _this5.deleteCategory(category.category_id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, \"Yes\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          _this5.setState({\n            comfirm_delete: true\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, \"No\"))), //open input for update category\n      open_update ? '' : React.createElement(\"div\", {\n        className: \"add-category\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        onSubmit: function onSubmit(e) {\n          _this5.updateCategory(e, category.category_id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        onChange: function onChange(e) {\n          _this5.setState({\n            name: e.target.value\n          });\n        },\n        value: name,\n        type: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \"Save\"))), image ? React.createElement(\"img\", {\n        src: image,\n        alt: \"image\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }) : '', //open input for add subcategory\n      open_add ? '' : React.createElement(\"div\", {\n        className: \"add-subcategory\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        onSubmit: function onSubmit(e) {\n          _this5.addSubCategory(e, category.category_id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        onChange: this.handleImage,\n        type: \"file\",\n        accept: \"image/x-png,image/gif,image/jpeg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        placeholder: \"Name subcategory\",\n        onChange: function onChange(e) {\n          _this5.setState({\n            name: e.target.value\n          });\n        },\n        type: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, \"Add\"))), React.createElement(\"div\", {\n        className: \"list-sub\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, //list sub categories\n      sub_categories.map(function (sub_category) {\n        return React.createElement(SubCategory, {\n          key: sub_category.sub_category_id,\n          update: _this5.fetchSubCategories,\n          data: sub_category,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        });\n      })));\n    }\n  }]);\n\n  return Category;\n}(Component);\n\nvar mapStateToProp = function mapStateToProp(state) {\n  return {\n    user: state.userReducer\n  };\n};\n\nexport default connect(mapStateToProp)(Category);","map":{"version":3,"sources":["E:\\ecart\\Admin-eCommerce-ReactJS\\src\\components\\Categories\\Category.jsx"],"names":["React","Component","axios","url","headers","_","connect","Loading","SubCategory","Category","state","open_update","open_add","comfirm_delete","name","message","sub_categories","loading","fetchSubCategories","get","props","category","category_id","then","res","console","log","data","isArray","datasub","setState","openUpdateCategory","openAddSubCategory","handleImage","e","file","target","files","reader","FileReader","readAsDataURL","onloadend","image","result","subcategories","id","delete","user","token","update","preventDefault","put","catch","err","formData","FormData","append","post","category_name","deleteCategory","updateCategory","value","addSubCategory","map","sub_category","sub_category_id","mapStateToProp","userReducer"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios'\nimport { url, headers } from '../../config'\nimport _ from 'lodash'\nimport { connect } from 'react-redux'\nimport Loading from '../Loading'\n\nimport SubCategory from './SubCategory'\n\nclass Category extends Component {\n    state = {\n        open_update : true,\n        open_add : true,\n        comfirm_delete : true,\n        name : '',\n        message : '',\n        sub_categories : [],\n        loading: false\n    }\n\n    componentDidMount() {\n        let sub_categories = this.props.category.subcategories\n        if(sub_categories){\n            this.setState({ sub_categories })\n        }\n        this.fetchSubCategories()\n    }\n\n    fetchSubCategories = () => {\n        axios.get( url + '/app/product/subcategory/' + this.props.category.category_id )\n        .then(res=>{ \n            console.log(res.data);\n            if( _.isArray(res.data.datasub) )\n                this.setState({ sub_categories: res.data.datasub })\n            else\n                this.setState({ sub_categories: [] })\n         })\n    }\n\n    deleteCategory(id) {   \n        axios.delete( url+ '/category/' + id , headers(this.props.user.token) )\n        .then(res=>{\n            this.props.update()\n        })\n    }\n\n\n    openUpdateCategory = (name) =>{\n        this.setState({ name, open_update: !this.state.open_update, message: '' })\n    }\n\n    updateCategory(e, id) {\n        e.preventDefault() \n        const data = {\n            name: this.state.name,\n        }\n\n        axios.put( url + '/category/' + id , data ,headers(this.props.user.token) )\n        .then(res=>{ \n            this.setState({ message: 'Success update category', open_update: true })\n            this.props.update()\n        })\n        .catch(err=>{ this.setState({ message: 'Failed update category' }) })\n    }\n\n    openAddSubCategory = () =>{\n        this.setState({ open_add: !this.state.open_add, message: '' })\n        \n    }\n\n    handleImage = (e) => {\n        let file = e.target.files[0]\n        let reader = new FileReader()\n\n        reader.readAsDataURL(file)\n\n        reader.onloadend = () => {\n            this.setState({\n                file: file,\n                image: reader.result\n            })\n        }\n    }\n\n    addSubCategory(e, id) {\n        e.preventDefault()\n        const { name, file } = this.state\n        this.setState({ loading: true })\n        let formData = new FormData()\n        formData.append('image', file)\n\n        axios.post( url + \"/subcategory/upload-image\", formData )\n        .then(res=>{\n            const data = {\n                name : name,\n                image : res.data.url,\n                category_id : id\n            }\n            axios.post( url + '/subcategory', data , headers(this.props.user.token) )\n            .then(res=>{\n                \n                this.fetchSubCategories()\n                this.setState({ message: 'Success add subcategory', open_add: true, name: '', image: null, loading: false })\n            })\n            .catch(err=>{\n                this.setState({ message: 'Failed add subcategory', loading: false })\n            })\n        })\n        .catch(err=>{\n           this.setState({ message: 'Failed upload image', loading: false})\n        })\n    }\n\n\n    render() {\n        const { loading, image, open_update, name, open_add, comfirm_delete, message, sub_categories } = this.state\n        const { category } = this.props\n        return (\n            <div>\n                { loading && <Loading /> }\n\n                <span className=\"message\">{message}</span>\n                <div className=\"category\">\n                    <div>\n                        <span>{category.category_name}</span>\n                    </div>\n                    <div className=\"actions\">\n                        <div onClick={()=>{this.setState({ comfirm_delete : false})}} className=\"delete\">\n                            <i className=\"demo-icon icon-minus\">&#xe814;</i>\n                        </div>\n                        <div onClick={()=>{this.openUpdateCategory(category.category_name)}} className=\"update\">\n                            <i className=\"demo-icon icon-cog\">&#xe81a;</i>\n                        </div>\n                        <div onClick={this.openAddSubCategory} className=\"add\">\n                            {\n                                open_add ?  <i className=\"demo-icon icon-plus\">&#xe808;</i> : <i className=\"demo-icon icon-cancel\">&#xe80f;</i>\n                            }\n                        </div>\n                    </div>\n                </div>\n                \n                { //open comfirm delete category\n                    comfirm_delete ? '' :\n                    <div className=\"comfirm-delete\">\n                        <div>\n                            <h3>Are you sure want to delete?</h3>\n                            <button onClick={()=>{this.deleteCategory(category.category_id)}}>Yes</button>\n                            <button onClick={()=>{this.setState({ comfirm_delete: true })}}>No</button>\n                        </div>\n                    </div>\n                }\n                \n\n                { //open input for update category\n                    open_update ? '' :\n                    <div className=\"add-category\">\n                        <form onSubmit={(e)=>{ this.updateCategory(e, category.category_id) }}>\n                            <input onChange={(e)=>{this.setState({ name: e.target.value })}} value={name} type=\"text\"/>\n                            <button type=\"submit\">Save</button>\n                        </form>\n                    </div>\n                }\n\n                { image ? <img src={image} alt=\"image\"/> : '' }\n\n\n                { //open input for add subcategory\n                    open_add ? '' :\n                    <div className=\"add-subcategory\">\n                        <form onSubmit={(e)=>{ this.addSubCategory(e, category.category_id) }}>\n                            <input onChange={this.handleImage}  type=\"file\" accept=\"image/x-png,image/gif,image/jpeg\"/>\n                            <input placeholder=\"Name subcategory\" onChange={(e)=>{this.setState({ name: e.target.value })}} type=\"text\"/>\n                            <button type=\"submit\">Add</button>\n                        </form>\n                    </div>\n                }\n                <div className=\"list-sub\">\n                { //list sub categories\n                    sub_categories.map(sub_category=>{\n                        return(\n                            <SubCategory key={sub_category.sub_category_id} update={this.fetchSubCategories} data={sub_category} />\n                        )\n                   })\n                }\n                </div>\n\n            </div>\n\n        );\n    }\n}\n\nconst mapStateToProp = (state) => {\n    return({\n        user: state.userReducer\n    })\n}\n\nexport default connect(mapStateToProp)(Category);"]},"metadata":{},"sourceType":"module"}