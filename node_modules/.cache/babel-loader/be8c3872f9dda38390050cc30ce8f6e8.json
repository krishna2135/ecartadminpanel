{"ast":null,"code":"import _classCallCheck from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"E:\\\\ecart\\\\Admin-eCommerce-ReactJS\\\\src\\\\components\\\\Products\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport './products.scss';\nimport axios from 'axios';\nimport { url } from '../../config';\nimport { connect } from 'react-redux';\nimport { categoryAction } from '../../actions';\nimport { Link } from 'react-router-dom';\nimport _ from 'lodash';\nimport Product from './Product';\nimport Header from '../Header';\nimport Navbar from '../Navbar';\n\nvar index =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(index, _Component);\n\n  function index() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, index);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(index)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      show: 'card',\n      loading: true,\n      products: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\n      categories: [],\n      subcategories: [],\n      category_id: 0,\n      sub_category_id: 0,\n      top: '100px',\n      search: ''\n    };\n\n    _this.fetchCategories = function () {\n      axios.get(url + '/app/category').then(function (res) {\n        if (_.isArray(res.data.data)) {\n          _this.props.categoryAction(res.data.data);\n\n          _this.setState({\n            categories: res.data.data,\n            loading: false\n          });\n        }\n      });\n    };\n\n    _this.fetchProducts = function () {\n      var products = JSON.parse(localStorage.getItem('products'));\n\n      if (_.isArray(products)) {\n        _this.setState({\n          products: products,\n          loading: false\n        });\n      }\n\n      axios.get(url + \"/product\").then(function (res) {\n        if (_.isArray(res.data)) _this.setState({\n          products: res.data,\n          loading: false\n        });\n        localStorage.setItem('products', JSON.stringify(res.data));\n      });\n    };\n\n    _this.selectCategory = function (e) {\n      var id = e.target.value;\n\n      _this.setState({\n        category_id: id,\n        sub_category_id: 0\n      });\n\n      if (id <= 0) {\n        _this.fetchProducts();\n      } else {\n        _this.fetchProductsCategory(id);\n      }\n\n      var categories = _this.state.categories;\n      var selectcategories = categories.filter(function (el) {\n        return el.category_id == id;\n      });\n\n      if (!_.isUndefined(selectcategories[0])) {\n        _this.setState({\n          subcategories: selectcategories[0].subcategories\n        });\n      } else {\n        _this.setState({\n          subcategories: []\n        });\n      }\n    };\n\n    _this.selectSubcategory = function (e) {\n      var id = e.target.value;\n      var category = _this.state.category_id;\n\n      _this.setState({\n        sub_category_id: id\n      });\n\n      if (id <= 0) {\n        _this.fetchProductsCategory(category);\n      } else {\n        var products = JSON.parse(localStorage.getItem(\"category\".concat(category).concat(id)));\n\n        if (_.isArray(products)) {\n          _this.setState({\n            products: products,\n            loading: false\n          });\n        }\n\n        axios.get(url + \"/product/category/\" + category + \"?idSub=\" + id).then(function (res) {\n          if (_.isArray(res.data)) {\n            localStorage.setItem(\"category\".concat(category).concat(id), JSON.stringify(res.data));\n\n            _this.setState({\n              products: res.data,\n              loading: false\n            });\n          }\n        });\n      }\n    };\n\n    _this.searchProduct = function (e) {\n      e.preventDefault();\n      axios.get(url + \"/product?search=\" + _this.state.search).then(function (res) {\n        if (_.isArray(res.data)) {\n          _this.setState({\n            products: res.data\n          });\n        }\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(index, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.fetchProducts();\n      var category = localStorage.getItem('categories');\n\n      if (_.isString(category)) {\n        var categories = JSON.parse(category);\n        if (_.isArray(categories)) this.setState({\n          categories: categories,\n          loading: false\n        });\n      }\n\n      this.fetchCategories();\n      window.addEventListener('scroll', function () {\n        var scroll = window.scrollY;\n\n        if (scroll > 0) {\n          _this2.setState({\n            top: '65px'\n          });\n        } else {\n          _this2.setState({\n            top: '100px'\n          });\n        }\n      });\n    }\n  }, {\n    key: \"fetchProductsCategory\",\n    value: function fetchProductsCategory(id) {\n      var _this3 = this;\n\n      var products = JSON.parse(localStorage.getItem(\"category\".concat(id)));\n\n      if (_.isArray(products)) {\n        this.setState({\n          products: products,\n          loading: false\n        });\n      }\n\n      axios.get(url + \"/product/category/\" + id).then(function (res) {\n        if (_.isArray(res.data)) {\n          localStorage.setItem(\"category\".concat(id), JSON.stringify(res.data));\n\n          _this3.setState({\n            products: res.data,\n            loading: false\n          });\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$state = this.state,\n          top = _this$state.top,\n          loading = _this$state.loading,\n          products = _this$state.products,\n          show = _this$state.show,\n          categories = _this$state.categories,\n          subcategories = _this$state.subcategories,\n          sub_category_id = _this$state.sub_category_id,\n          category_id = _this$state.category_id,\n          message = _this$state.message;\n      return React.createElement(\"div\", {\n        className: \"products\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }), React.createElement(Navbar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/addproduct\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          top: top,\n          transition: '0.5s'\n        },\n        className: \"new\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"demo-icon icon-plus\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, \"\\uE808\"))), React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \"Products\"), React.createElement(\"div\", {\n        className: \"show\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: show === 'card' ? 'active' : '',\n        onClick: function onClick() {\n          return _this4.setState({\n            show: 'card'\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, \"cards\")), React.createElement(\"div\", {\n        className: show === 'table' ? 'active' : '',\n        onClick: function onClick() {\n          return _this4.setState({\n            show: 'table'\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, \"table\"))), React.createElement(\"div\", {\n        className: \"wrapper-search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        style: {\n          marginRight: \"27px\"\n        },\n        htmlFor: \"category\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, \"Category\"), React.createElement(\"select\", {\n        value: category_id,\n        onChange: this.selectCategory,\n        name: \"category\",\n        id: \"category\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, \"All\"), categories && categories.map(function (category) {\n        return React.createElement(\"option\", {\n          key: category.category_id,\n          value: category.category_id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        }, category.category_name);\n      }))), React.createElement(\"div\", {\n        className: \"search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"category\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, \"Subcategory\"), React.createElement(\"select\", {\n        value: sub_category_id,\n        onChange: this.selectSubcategory,\n        name: \"category\",\n        id: \"category\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, \"All\"), subcategories && subcategories.map(function (category) {\n        return React.createElement(\"option\", {\n          key: category.sub_category_id,\n          value: category.sub_category_id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186\n          },\n          __self: this\n        }, category.name);\n      }))), React.createElement(\"div\", {\n        className: \"search-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        onSubmit: this.searchProduct,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        placeholder: \"Search product\",\n        onChange: function onChange(e) {\n          return _this4.setState({\n            search: e.target.value\n          });\n        },\n        type: \"search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"demo-icon icon-search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, \"\\uE806\"))))), // loading product\n      loading ? React.createElement(\"div\", {\n        className: show,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, products.map(function (num) {\n        return React.createElement(\"div\", {\n          key: num,\n          className: \"loading-list\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200\n          },\n          __self: this\n        }));\n      })) : React.createElement(\"div\", {\n        className: show,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, //list all products\n      products.length === 0 ? React.createElement(\"span\", {\n        style: {\n          color: \"red\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, \"Empty\") : products.map(function (product) {\n        return React.createElement(Product, {\n          key: product.product_id,\n          product: product,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204\n          },\n          __self: this\n        });\n      }))));\n    }\n  }]);\n\n  return index;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    categories: state.categoriesReducer,\n    user: state.userReducer\n  };\n};\n\nexport default connect(mapStateToProps, {\n  categoryAction: categoryAction\n})(index);","map":{"version":3,"sources":["E:\\ecart\\Admin-eCommerce-ReactJS\\src\\components\\Products\\index.jsx"],"names":["React","Component","axios","url","connect","categoryAction","Link","_","Product","Header","Navbar","index","state","show","loading","products","categories","subcategories","category_id","sub_category_id","top","search","fetchCategories","get","then","res","isArray","data","props","setState","fetchProducts","JSON","parse","localStorage","getItem","setItem","stringify","selectCategory","e","id","target","value","fetchProductsCategory","selectcategories","filter","el","isUndefined","selectSubcategory","category","searchProduct","preventDefault","isString","window","addEventListener","scroll","scrollY","message","transition","marginRight","map","category_name","name","num","length","color","product","product_id","mapStateToProps","categoriesReducer","user","userReducer"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './products.scss'\nimport axios from 'axios'\nimport { url } from '../../config'\nimport { connect } from 'react-redux'\nimport { categoryAction } from '../../actions'\nimport { Link } from 'react-router-dom'\nimport _ from 'lodash'\n\nimport Product from './Product'\nimport Header from '../Header'\nimport Navbar from '../Navbar'\n\nclass index extends Component {\n    state = {\n        show: 'card',\n        loading : true,\n        products : [1,2,3,4,5,6,7,8,9,10],\n        categories : [],\n        subcategories : [],\n        category_id : 0,\n        sub_category_id: 0,\n        top : '100px',\n        search : ''\n    }\n\n\n    componentDidMount(){\n        this.fetchProducts()\n        let category = localStorage.getItem('categories')\n        if(_.isString(category)){\n            let categories = JSON.parse(category)\n            if(_.isArray(categories))\n                this.setState({ categories, loading: false })\n        }\n        this.fetchCategories()\n\n        window.addEventListener('scroll', ()=>{\n            let scroll =  window.scrollY\n            if( scroll>0 ) {\n                this.setState({ top: '65px' })\n            } else {\n                this.setState({ top: '100px' })\n            }\n        })\n    }\n\n    fetchCategories = () => {\n        axios.get( url + '/app/category' )\n        .then(res=>{\n            if(_.isArray(res.data.data)){\n                this.props.categoryAction(res.data.data)\n                this.setState({ categories: res.data.data, loading: false })\n            }\n        })\n    }\n\n    \n\n    fetchProducts = () => {\n        let products = JSON.parse(localStorage.getItem('products'))\n        if(_.isArray(products)){\n            this.setState({ products, loading: false })\n        }\n        axios.get( url + \"/product\" )\n        .then(res=>{\n            if( _.isArray(res.data) )\n                this.setState({ products: res.data, loading: false })\n                localStorage.setItem('products', JSON.stringify(res.data))\n        })\n    }\n\n    selectCategory = (e) => {\n        let id = e.target.value\n\n        this.setState({ category_id: id, sub_category_id: 0 })\n        if(id <= 0){\n            this.fetchProducts()\n        } else {\n            this.fetchProductsCategory(id)\n        }\n\n        let categories = this.state.categories\n        let selectcategories = categories.filter((el)=>{\n            return(\n                el.category_id == id\n            )\n        })\n\n        if(!_.isUndefined(selectcategories[0])){\n            this.setState({ subcategories: selectcategories[0].subcategories })\n        } else {\n            this.setState({ subcategories: [] })\n        }\n    }\n\n    fetchProductsCategory(id){\n        let products = JSON.parse(localStorage.getItem(`category${id}`))\n        if(_.isArray(products)){\n            this.setState({ products, loading: false })\n        }\n\n        axios.get( url + \"/product/category/\" + id )\n        .then(res=>{\n            if(_.isArray(res.data)){\n                localStorage.setItem(`category${id}`, JSON.stringify(res.data))\n                this.setState({ products: res.data, loading: false })\n            }\n        })\n    }\n\n    selectSubcategory = (e) => {\n        let id = e.target.value\n        let category = this.state.category_id\n        this.setState({ sub_category_id: id })\n        if(id <= 0){\n            this.fetchProductsCategory(category)\n        } else {\n            let products = JSON.parse(localStorage.getItem(`category${category}${id}`))\n            if(_.isArray(products)){\n                this.setState({ products, loading: false })\n            }\n\n            axios.get( url + \"/product/category/\" + category + \"?idSub=\" + id )\n            .then( res => {\n                if(_.isArray(res.data)){\n                    localStorage.setItem(`category${category}${id}`, JSON.stringify(res.data))\n                    this.setState({ products: res.data, loading: false })\n                }\n            } )\n        }\n    }\n\n    searchProduct = (e) => {\n        e.preventDefault()\n        axios.get( url + \"/product?search=\" + this.state.search )\n        .then(res =>{\n            if(_.isArray(res.data)){\n                this.setState({ products: res.data })\n            }\n        })\n    }\n\n    render() {\n        const { top, loading, products, show, categories, subcategories, sub_category_id, category_id, message } = this.state\n        return (\n            <div className=\"products\">\n                <Header />\n                <Navbar />\n\n                <div className=\"wrapper\">\n\n                    <Link to=\"/addproduct\">\n                    <div style={{ top: top, transition: '0.5s' }} className=\"new\">\n                        <i className=\"demo-icon icon-plus\">&#xe808;</i>\n                    </div>\n                    </Link>\n\n                    <span>Products</span>\n\n                    <div className=\"show\">\n                        <div className={ show === 'card' ? 'active' : '' } onClick={()=> this.setState({ show: 'card' })}>\n                            <span>cards</span>\n                        </div>\n                        <div className={ show === 'table' ? 'active' : '' }  onClick={()=> this.setState({ show: 'table' })} >\n                            <span>table</span>\n                        </div>\n                    </div>\n\n                    <div className=\"wrapper-search\">\n                        <div className=\"search\">\n                            <label style={{marginRight: \"27px\"}} htmlFor=\"category\">Category</label>\n                            <select value={category_id} onChange={this.selectCategory} name=\"category\" id=\"category\">\n                                <option value=\"0\">All</option>\n                                {\n                                categories && categories.map( category => <option key={category.category_id} value={category.category_id}>{category.category_name}</option> )\n                                }\n                            </select>\n                        </div>\n\n                        <div className=\"search\">\n                            <label htmlFor=\"category\">Subcategory</label>\n                            <select value={sub_category_id} onChange={this.selectSubcategory} name=\"category\" id=\"category\">\n                                <option value=\"0\">All</option>\n                                {\n                                subcategories && subcategories.map( category => <option key={category.sub_category_id} value={category.sub_category_id}>{category.name}</option> )\n                                }\n                            </select>\n                        </div>\n\n                        <div className=\"search-input\">\n                            <form onSubmit={this.searchProduct}>\n                                <input placeholder=\"Search product\" onChange={(e)=>this.setState({ search: e.target.value })} type=\"search\"/>\n                                <button type=\"submit\"><i className=\"demo-icon icon-search\">&#xe806;</i></button>\n                            </form>\n                        </div>\n                    </div>\n\n                    { // loading product\n                        loading ? <div className={show}>{ products.map(num=> <div key={num} className=\"loading-list\"><div></div><div></div><div></div></div> ) }</div> :\n                        <div className={show}>\n                            { //list all products\n                                products.length === 0 ? <span style={{color: \"red\"}}>Empty</span> :\n                                products.map(product=> <Product key={product.product_id} product={product} /> )\n                            }\n                        </div>\n                    }\n\n                </div>\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return({\n        categories : state.categoriesReducer,\n        user : state.userReducer\n    })\n}\n\nexport default connect(mapStateToProps , { categoryAction })(index);"]},"metadata":{},"sourceType":"module"}